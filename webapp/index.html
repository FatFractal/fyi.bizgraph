<!doctype html>
<html lang="en" ng-app="ffConsole">
<head>
    <meta charset="utf-8">
    <title>The FatFractal FYI Test Harness</title>
    <script type="text/javascript">
    function httpsRedirect() {
        var httpURL = window.location.hostname + window.location.pathname;
        var httpsURL = "https://" + httpURL;
        window.location = httpsURL;
    }
    console.log(window.location.href);
    console.log(!window.location.href.match('^https://') && !window.location.href.match('^http://localhost'));
    if (!window.location.href.match('^https://') && !window.location.href.match('^http://localhost'))
    httpsRedirect();
    </script>
    <!-- Custom CSS for this app -->
    <link rel="stylesheet" href="css/app.css"/>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <!-- Latest FatFractal SDK -->
    <script src="//www.fatfractal.com/prod/js/FatFractal.latest.js"></script>
    <!-- Some useful utilities -->
    <script src="js/utils.js"></script>
    <!-- JSON formatter -->
    <script src="js/beautify.js"></script>
</head>
<!--
<body onunload="cleanUp()">
-->
<body>
    <div class="navbar" id="navbar" ng-controller="LoginCtrl">
        <div class="navbar-inner">
            <img src="img/beta.png" width="240px" class="brand pull-left">
            <h1 style="margin: 20px -20px">Test Harness</h1>
            <div class="span4" ui-if="refreshing" ng-cloak spinner style="margin: 20px -20px"></div>
        </div>
    </div>
    <div class="well" id = "top-level-section">
        <div class="well" id = "intro-section">
            <h1>FYI - Another Datagraph example</h1>
            <p>This post demonstrates real examples of working with FatFractal's datagraph with more of an enterprise feel.
            </p>
            <h4>You can see the data created by this app using the FatFractal DataBrowser (
                <a href = https://beta.fatfractal.com/databrowser/console/databrowser/databrowser.html?baseUrl=https://fyi.fatfractal.com/bizgraph target = _blank>
                    here
                </a>
                )
            </h4>
            <h4>You can access the source code for the sample application (
                <a href = https://github.com/FatFractal/fyi.bizgraph target = _blank>
                    here
                </a>
                )
            </h4>
            <h4>You can see the API metadata for this application (
                <a href = https://fyi.fatfractal.com/bizgraph/ff/metadata/text target = _blank>
                    here
                </a>
                )
            </h4>
        </div>
        <div class="well" id = "ffdl-section">
            <h2>FFDL</h2>
            <p>This test application includes the following ffdl definition.<br></p>	
            <div class="well">
                CREATE OBJECTTYPE Customer (firstName STRING, lastName STRING, gender STRING, mother REFERENCE /Customers, father REFERENCE /Customers, siblings GRABBAG /Customers, picture BYTEARRAY)<br>
                CREATE COLLECTION /Customers OBJECTTYPE Customer
            </div>
        </div>
        <div class="well" id = "customer-graph-section">
            <h2>The Customer Graph</h2>
            <p>This example shows the graph response for a random Customer object. Note that the Customer object has embedded FFUser and Address objects and the Address object has an embedded Location object.</p>
            <button id="customer-graph-button" class="btn" onclick="getRandomCustomerGraph()">Try it!</button><br><br>
            <ul class="nav nav-tabs" role="tablist" id = "customer-graph-tabs">
                <li class="active"><a href="#customer-graph-request" role="tab" data-toggle="tab">Request</a></li>
                <li><a href="#customer-graph-models" role="tab" data-toggle="tab">Models</a></li>
                <li><a href="#customer-graph-response" role="tab" data-toggle="tab">Response</a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane active" id="customer-graph-request">
                    <h3>The SDK request looks like this:</h3>
                    <div class="well">
                        <p>var customer;<br>
                            ff.getObjFromUri("/Customers/(guid eq random(guid))", function(obj) {<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;customer = obj;<br>
                            });<br>
                        </p>
                    </div>
                </div>
                <div class="tab-pane" id="customer-graph-models">
                    <h3>The client models used with this example are:</h3>
                    <div class="well">
                        <p>function Customer(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.user = new FFUser();<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.firstName = obj.firstName;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.lastName = obj.lastName;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.email = obj.email;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.phone = obj.phone;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.address = new Address();<br>
                        }</p>
                        <p>function FFUser() {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.firstName = null;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.lastName = null;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.email = null;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.userName = null;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.active = null;<br>
                        }</p>
                        <p>function Address(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.street = obj.street<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.city = obj.city;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.state = obj.state;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.country = obj.country;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.postCode = obj.postCode;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.location = new Location();<br>
                        }</p>
                        <p>function Location(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.geo = obj.geo<br>
                        }</p>
                    </div>
                </div>
                <div class="tab-pane" id="customer-graph-response">...</div>
            </div>
        </div>
        <div class="well" id = "orders-permissions-section">
            <h2>Orders with Permissions</h2>
            <p>This example shows how declarative permissions can be used to control access to data using permissions.</p>
            <button id="orders-permissions-customer-button" class="btn" onclick="getAllOrdersWithPermissions('nickelskevin@gmail.com','Iwantin123')">Customer</button>
            <button id="orders-permissions-vendor-button" class="btn" onclick="getAllOrdersWithPermissions('adam@bestbuy.com','Iwantin123')">Vendor</button>
            <button id="orders-permissions-mfg-button" class="btn" onclick="getAllOrdersWithPermissions('adam@zojurushi.com','Iwantin123')">Manufacturer</button>         
            <button id="orders-permissions-admin-button" class="btn" onclick="getAllOrdersWithPermissions('adam@bizgraph.com','Iwantin123')">System Administrator</button><br><br>
            <ul class="nav nav-tabs" role="tablist" id = "orders-permissions-tabs">
                <li class="active"><a href="#orders-permissions-request" role="tab" data-toggle="tab">Request</a></li>
                <li><a href="#orders-permissions-models" role="tab" data-toggle="tab">Models</a></li>
                <li><a href="#orders-permissions-response-orders" role="tab" data-toggle="tab">Orders</a></li>
                <li><a href="#orders-permissions-response-json" role="tab" data-toggle="tab">JSON Response</a></li>
            </ul>
            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane active" id="orders-permissions-request">
                    <h3>The SDK request looks like this:</h3>
                    <div class="well">
                        <p>var ordersArray;<br>
                            ff.getObjFromUri("/Orders", function(obj) {
                                &nbsp;&nbsp;&nbsp;&nbsp;ordersArray = obj;<br>
                            });<br>
                        </p>
                    </div>
                </div>
                <div class="tab-pane" id="orders-permissions-models">
                    <h3>The client models used with this example are:</h3>
                    <div class="well">
                        <p>function Order(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.customer = new Customer();<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.cendor = new Vendor();<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.total = obj.total;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.placedAt = New Address(obj.placedAt);<br>
                        }</p>
                        <p>function Customer(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.user = new FFUser();<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.firstName = obj.firstName;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.lastName = obj.lastName;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.email = obj.email;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.phone = obj.phone;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.address = new Address(obj.address);<br>
                        }</p>
                        <p>function Vendor(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.name = obj.name;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.address = new Address(obj.address);<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.logo = obj.logo;<br>
                        }</p>
                        <p>function Address(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.street = obj.street<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.city = obj.city;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.state = obj.state;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.country = obj.country;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.postCode = obj.postCode;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.location = new Location(obj.location);<br>
                        }</p>
                        <p>function Location(obj) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;this.geo = obj.geo<br>
                        }</p>
                    </div>
                </div>
                <div class="tab-pane" id="orders-permissions-response-orders">...</div>
                <div class="tab-pane" id="orders-permissions-response-json">...</div>
            </div>
        </div>
        <div class="well" id = "backreference-section">
            <h2>Back References</h2>
            <p>This test will show you how to retrieve objects using Back References. There are three tests here - the first gets all backreferences to "homer". The second gets all the Customer objects from the Grab Back that reference homer by the "siblings" Reference member. The third gets all the Customer objects that refer to homer by the "father" Reference member.</p>
            <div class="well">
                <p>var homer, allBackRefs;<br>
                    ff.grabBagGetAll(homer, "BackReferences", function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;allBackRefs = response;<br>
                    });<br>
                </p>
                <p>var homer, allSiblingBackRefs;<br>
                    ff.grabBagGetAll(homer, "BackReferences.Customers.siblings", function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;allSiblingBackRefs = response;<br>
                    });<br>
                </p>
                <p>var homer, allFatherBackRefs;<br>
                    ff.grabBagGetAll(homer, "BackReferences.Customers.father", function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;allFatherBackRefs = response;<br>
                    });<br>
                </p>
            </div>
            <button id="all-backreference-button" class="btn" onclick="getAllBackReferences('Homer')">Get all Backreferences!</button>
            <button id="siblings-backreference-button" class="btn" onclick="getSiblingsBackReferences('Homer')">Get siblings Backreferences!</button>
            <button id="father-backreference-button" class="btn" onclick="getFatherBackReferences('Homer')">Get father Backreferences!</button>
            <br>
            <p id = "backreference-response"></p>
        </div>
        <div class="well" id = "query-section">
            <h2>Queries</h2>
            <p>This test will show you how to retrieve objects using various queries. There are five examples in this section. The first example will get all the Customer objects that have a "father" Reference member (Note that the returned values are deduplicated). The second is basically the same, but uses the "mother" Reference member. The third example shows the use of a logical OR to get all of Bart's granparents. The fourth example is similar, but adds another locical OR to get all of Bart's granparents. The last shows a complex query to get all of Ling's cousins.</p>
            <div class="well">
                <p>var orders;<br>
                    ff.getArrayFromUri("/Orders"), function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;fathers = response;<br>
                    });<br>
                </p>
                <p>var mothers;<br>
                    ff.getArrayFromUri("/Customers/()/mother"), function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;mothers = response;<br>
                    });<br>
                </p>
                <p>var grandfathers;<br>
                    ff.getArrayFromUri("/Customers/(firstName eq 'Bart')/father or mother/()/father"), function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;grandfathers = response;<br>
                    });<br>
                </p>
                <p>var grandparents;<br>
                    ff.getArrayFromUri("/Customers/(firstName eq 'Bart')/father or mother/()/mother or father"), function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;grandparents = response;<br>
                    });<br>
                </p>
                <p>var cousins;<br>
                    ff.getArrayFromUri("/Customers/(firstName eq 'Ling')/father or mother/()/siblings/()/BackReferences.Customers.mother or BackReferences.Customers.father"), function(response) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;cousins = response;<br>
                    });<br>
                </p>
            </div>
            <button id="orders-query-button" class="btn" onclick="everyOrderQuery()">All fathers!</button>
            <button id="mothers-query-button" class="btn" onclick="everyMotherQuery()">All mothers!</button>
            <button id="grandorders-query-button" class="btn" onclick="grandfathersQuery('Bart')">Bart's grandfathers!</button>
            <button id="grandparents-query-button" class="btn" onclick="grandparentsQuery('Bart')">Bart's grandparents!</button>
            <button id="cousins-query-button" class="btn" onclick="cousinsQuery('Ling')">Ling's cousins!</button>
            <br>
            <p id = "query-response"></p>
        </div>
        <div class="well" id = "datagraph-section">
            <h2>Datagraph</h2>
            <p>This test will fetch the entire datagraph.
                <div class="well">
                    <p>var datagraph;<br>
                        ff.getArrayFromUri("/Customers/()?depthRef=3&depthGb=3", function(response) {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;datagraph = response;<br>
                        });
                    </p>
                </div>
                <button id="get-datagraph-button" class="btn" onclick="getCustomerGraph()">Try it!</button>
                <br>
                <p id = "get-datagraph-response"></p>
            </div>
            <h3>The following Model is used with this post</h3>
            <div class="well">
                <p>function Customer(obj) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.user = new FFUser();<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.firstName = obj.firstName;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.lastName = obj.firstName;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.email = obj.email;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.phone = obj.phone;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.address = new Address();<br>
                }</p>
                <p>function Address(obj) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.street = obj.street<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.city = obj.city;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.state = obj.state;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.country = obj.country;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.postCode = obj.postCode;<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.location = new Location();<br>
                }</p>
                <p>function Location(obj) {<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;this.geo = obj.geo<br>
                }</p>
            </div>
        </div>
    </div>
</body>
<!--Scripts-->
<script type="text/javascript">
// View elements
function OrderLineT(orderLines) {
    var wrap = document.createElement("div");
    wrap.className = "well";
    var ordersT = document.createElement("t");
    var ordersTHR = document.createElement("tr");
    wrap.appendChild(ordersT);
    wrap.appendChild(ordersTHR);
    ordersTHR.innerHTML = "<th>Item</th><th>Quantity</th><th>Description</th><th>Price</th><th>Total</th>";
    for(var i = 0; i < orderLines.length; i++) {
        var ol = new OrderLine(orderLines[i]);
        var mediaDiv = document.createElement("div");
        mediaDiv.className = "media";
        var imgA = document.createElement("a");
        imgA.className = "pull-left";
        imgA.style.clear = 'both'
        var img = document.createElement("img");
        img.className = "media-object";
        img.src = "/bizgraph"+ol.product.mfg.logo;
        var mediaHeading = document.createElement("p");
        mediaHeading.innerHTML = ol.product.mfg.name;
        mediaHeading.className = "media-heading";		     
        ff.getObjFromUri(ol.metadata.ffUrl+"/BackReferences.ProductImages.image", function(pi) {
            var p = new ProductImage(pi);
            var itemTR = document.createElement("tr");
            itemTR.innerHTML = "<td><img src="+p.image+"</td><td>"+ol.quantity+"</td><td>"+ol.description+"</td><td>"+ol.price+"</td><td>"+ol.total+"</td>";
            ordersT.appendChild(itemTR);
        }, function(code, msg) {
            ordersWrap.innerHTML = "<br><div class = 'well red'>OrderElement.getObjFromUri() error: " + msg + "</div>";
            console.error("OrderElement.getObjFromUri() Error: " + code + " " + msg);
        });
    }
    return wrap;    
}

function OrderElement(order) {
    var ordersWrap = document.createElement("div");
    ordersWrap.className = "well";
    var mediaDiv = document.createElement("div");
    mediaDiv.className = "media";
    var imgA = document.createElement("a");
    imgA.className = "pull-left";
    imgA.style.clear = 'both'
    var img = document.createElement("img");
    img.className = "media-object";
    img.src = "/bizgraph"+order.vendor.logo;
    var mediaHeading = document.createElement("p");
    var v = order.vendor.name;
    var d = new Date(order.metadata.createdAt);
    mediaHeading.innerHTML = "Placed with <strong>"+v+"</strong> on "+d;
    mediaHeading.className = "media-heading";		 
    var mediaBody = document.createElement("div");
    ff.getArrayFromUri(order.metadata.ffUrl+"/BackReferences.OrderLines", function(ols) {
        if(!ols || ols.length <= 0) {
            ordersWrap.innerHTML = "You do not have permission to see any OrderLine objects from the /OrderLines collection."
        } else {
            console.log("OrderElement.getArrayFromUri() retrieved: " + ols.length + " OrderLines");
            console.log("OrderElement.getArrayFromUri() retrieved: " + JSON.stringify(ols));
            var olT = new OrderLineT(ols);
            mediaBody.innerHTML += "<br>Order total: "+order.total;
        }
    }, function(code, msg) {
        ordersWrap.innerHTML = "<br><div class = 'well red'>OrderElement.getObjFromUri() error: " + msg + "</div>";
        console.error("OrderElement.getObjFromUri() Error: " + code + " " + msg);
    });
    return ordersWrap;    
}
// View methods
function getRandomCustomerGraph() {
    var el = document.getElementById('customer-graph-response');
    el.innerHTML = "";
    ff.login("adam@bizgraph.com", "Iwantin123", function() {
        ff.getObjFromUri("/Customers/(guid eq random(guid))", function(obj) {
            var str = "";
            var elStr = "";
            if(!obj) alert("Create some Customer objects in the Customers Collection first!");
            else {
                var heading = document.createElement("h3");
                heading.innerHTML = "Response:"
                el.appendChild(heading);
                var p = new Customer(obj);
                str = js_beautify(JSON.stringify(p), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                el.appendChild(wellWrap);
                var responseP = document.createElement("p");
                wellWrap.appendChild(responseP);
                elStr = "A Customer object was retrieved from the /Customers Collection with data: " + str;
                responseP.innerHTML = elStr;
                $('#customer-graph-tabs a[href="#customer-graph-response"]').tab('show') // Select tab by name
            }
        }, function(code, msg) {
            el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
            console.error("getCustomerGraph.getArrayFromUri() getArrayFromUri Error: " + code + " " + msg);
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got a login error: " + msg + "</div>";
        console.error("getCustomerGraph.login() Error: " + code + " " + msg);
    });
}
function getAllOrdersWithPermissions(u, p) {
    var ordersEl = document.getElementById('orders-permissions-response-orders');
    var el = document.getElementById('orders-permissions-response-json');
    el.innerHTML = "";
    ordersEl.innerHTML = "";
    console.log("getAllOrdersWithPermissions logging is as userName: "+u+", password: "+p);
    ff.login(u, p, function() {
        ff.getArrayFromUri("/Orders", function(arr) {
            var str = "";
            var elStr = "";
            var heading = document.createElement("h3");
            heading.innerHTML = "Response:"
            el.appendChild(heading);
            var ordersH3 = document.createElement("h3");
            ordersEl.appendChild(ordersH3);
            var ordersP = document.createElement("p");
            ordersEl.appendChild(ordersP);
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            el.appendChild(wellWrap);
            var responseP = document.createElement("p");
            if(!arr || arr.length <= 0) {
                elStr = "You do not have permission to see any Order objects from the /Orders collection."
            } else {
                for(var i = 0; i < arr.length; i++) {
                    var order = new Order(arr[i]);
                    ordersH3.innerHTML = "Orders for: "+order.customer.firstName+" "+order.customer.lastName;
                    ordersP.innerHTML = order.customer.address.number+" "+order.customer.address.street+"<br>"+
                    order.customer.address.city+", "+order.customer.address.state+", "+order.customer.address.postCode+", "+order.customer.address.country;
                    var orderMeta = new FFMetaData(arr[i]);
                    console.log(JSON.stringify(orderMeta));
                    // common elements
                    var mediaDiv = document.createElement("div");
                    mediaDiv.className = "media";
                    var imgA = document.createElement("a");
                    imgA.className = "pull-left";
                    imgA.style.clear = 'both'
                    var img = document.createElement("img");
                    img.className = "media-object";
                    img.src = "/bizgraph"+order.vendor.logo;
                    var mediaHeading = document.createElement("p");
                    mediaHeading.className = "media-heading";		 
                    var mediaBody = document.createElement("div");
                    mediaBody.className = "media-body";		 
                    mediaDiv.appendChild(imgA);
                    imgA.appendChild(img); 
                    mediaDiv.appendChild(mediaHeading); 
                    mediaDiv.appendChild(mediaBody); 
                    // Order form element
                    var orderEl = new OrderElement(order);
                    ordersEl.appendChild(orderEl);
                    // JSON response view
                    wellWrap.appendChild(mediaDiv);
                    var word = "object was";
                    if(arr.length > 1) word = "objects were"
                    elStr = arr.length +" Order "+word+" retrieved from the /Orders Collection with data: ";
                    str = js_beautify(JSON.stringify(order), {
                        indent_size: 4,
                        indent_char: '&nbsp;',
                        linefeed_char: '<br>'
                    });
                    elStr += str;
                }
            }
            wellWrap.appendChild(responseP);
            responseP.innerHTML = elStr;
            $('#orders-permissions-tabs a[href="#orders-permissions-response-orders"]').tab('show') // Select tab by name
        }, function(code, msg) {
            el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
            ordersEl.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
            console.error("getAllOrdersWithPermissions.getArrayFromUri() getArrayFromUri Error: " + code + " " + msg);
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got a login error: " + msg + "</div>";
        ordersEl.innerHTML = "<br><div class = 'well red'>Got a login error: " + msg + "</div>";
        console.error("getAllOrdersWithPermissions.login() Error: " + code + " " + msg);
    });
}
function getCustomerGraph() {
    var el = document.getElementById('get-datagraph-response');
    el.innerHTML = "";
    ff.login("adam@bizgraph.com", "Iwantin123", function() {
        ff.getArrayFromUri("/Customers", function(arr) {
            var str = "";
            var elStr = "";
            var outArray = [];
            if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
            else {
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                var mediaDiv = document.createElement("div");
                mediaDiv.className = "media";
                var mediaBody = document.createElement("div");
                mediaBody.className = "media-body";		 
                var mediaHeading = document.createElement("p");
                mediaHeading.className = "media-heading";		 
                el.appendChild(wellWrap);
                wellWrap.appendChild(mediaDiv);
                for(var i = 0; i < arr.length; i++) {
                    var p = new Customer(arr[i]);
                    outArray.push(p);
                    // var imgA = document.createElement("a");
                    // imgA.className = "pull-left";
                    // imgA.style.clear = 'both';
                    // var img = document.createElement("img");
                    // img.className = "media-object";
                    // img.src = arrayBufferToDataUri(arr[i].picture);
                    // imgA.appendChild(img);
                    // mediaDiv.appendChild(imgA);
                }
                str = js_beautify(JSON.stringify(outArray), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                mediaDiv.appendChild(mediaBody); 
                mediaBody.appendChild(mediaHeading); 
                elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
                mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
            }
        }, function(code, msg) {
            el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
            console.error("getCustomerGraph.getArrayFromUri() getArrayFromUri Error: " + code + " " + msg);
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got a login error: " + msg + "</div>";
        console.error("getCustomerGraph.login() Error: " + code + " " + msg);
    });
}
function getReferenceFromCustomerByFirstName(firstName) {
    var el = document.getElementById('customer-reference-response');
    el.innerHTML = "";
    ff.getObjFromUri("/Customers/(firstName eq '" + firstName + "')/father", function(p) {
        var customer = new Customer(p);
        var str = "";
        var elStr = "";
        if(!customer) alert("Could not find Customer with firstName " + firstName + "!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var imgA = document.createElement("a");
            imgA.className = "pull-left";
            imgA.style.clear = 'both'
            var img = document.createElement("img");
            img.className = "media-object";
            img.src = arrayBufferToDataUri(customer.picture);
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            mediaDiv.appendChild(imgA);
            imgA.appendChild(img); 
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            var printMe = customer.printMe();
            str = js_beautify(JSON.stringify(printMe), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            elStr += "Customer was retrieved from the  " +
            p.ffRL + " Collection with data: " +
            str + "<br>";
            mediaHeading.innerHTML = elStr;
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getCustomer() getObjFromUri Error: " + code + " " + msg);
    });
}
function getGrabbagFromCustomerByFirstName(firstName) {
    var el = document.getElementById('get-grabbag-response');
    el.innerHTML = "";
    ff.getArrayFromUri("/Customers/(firstName eq '" + firstName + "')/mother/()/siblings/(gender eq 'Female')", function(arr) {
        var str = "";
        var elStr = "";
        var outArray = [];
        if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            for(var i = 0; i < arr.length; i++) {
                var p = new Customer(arr[i]).printMe();
                outArray.push(p);
                var imgA = document.createElement("a");
                imgA.className = "pull-left";
                imgA.style.clear = 'both'
                var img = document.createElement("img");
                img.className = "media-object";
                img.src = arrayBufferToDataUri(arr[i].picture);
                imgA.appendChild(img); 
                mediaDiv.appendChild(imgA);
            }
            str = js_beautify(JSON.stringify(outArray), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
            mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function getAllBackReferences(firstName) {
    var el = document.getElementById('backreference-response');
    el.innerHTML = "";
    ff.getObjFromUri("/Customers/(firstName eq '" + firstName + "')", function(obj) {
        ff.grabBagGetAll(obj, "BackReferences", function(arr) {
            var str = "";
            var elStr = "";
            var outArray = [];
            if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
            else {
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                var mediaDiv = document.createElement("div");
                mediaDiv.className = "media";
                var mediaBody = document.createElement("div");
                mediaBody.className = "media-body";		 
                var mediaHeading = document.createElement("p");
                mediaHeading.className = "media-heading";		 
                el.appendChild(wellWrap);
                wellWrap.appendChild(mediaDiv);
                for(var i = 0; i < arr.length; i++) {
                    var p = new Customer(arr[i]).printMe();
                    outArray.push(p);
                    var imgA = document.createElement("a");
                    imgA.className = "pull-left";
                    imgA.style.clear = 'both'
                    var img = document.createElement("img");
                    img.className = "media-object";
                    img.src = arrayBufferToDataUri(arr[i].picture);
                    imgA.appendChild(img); 
                    mediaDiv.appendChild(imgA);
                }
                str = js_beautify(JSON.stringify(outArray), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                mediaDiv.appendChild(mediaBody); 
                mediaBody.appendChild(mediaHeading); 
                elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
                mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
            }
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function getSiblingsBackReferences(firstName) {
    var el = document.getElementById('backreference-response');
    el.innerHTML = "";
    ff.getObjFromUri("/Customers/(firstName eq '" + firstName + "')", function(obj) {
        ff.grabBagGetAll(obj, "BackReferences.Customers.siblings", function(arr) {
            var str = "";
            var elStr = "";
            var outArray = [];
            if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
            else {
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                var mediaDiv = document.createElement("div");
                mediaDiv.className = "media";
                var mediaBody = document.createElement("div");
                mediaBody.className = "media-body";		 
                var mediaHeading = document.createElement("p");
                mediaHeading.className = "media-heading";		 
                el.appendChild(wellWrap);
                wellWrap.appendChild(mediaDiv);
                for(var i = 0; i < arr.length; i++) {
                    var p = new Customer(arr[i]).printMe();
                    outArray.push(p);
                    var imgA = document.createElement("a");
                    imgA.className = "pull-left";
                    imgA.style.clear = 'both'
                    var img = document.createElement("img");
                    img.className = "media-object";
                    img.src = arrayBufferToDataUri(arr[i].picture);
                    imgA.appendChild(img); 
                    mediaDiv.appendChild(imgA);
                }
                str = js_beautify(JSON.stringify(outArray), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                mediaDiv.appendChild(mediaBody); 
                mediaBody.appendChild(mediaHeading); 
                elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
                mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
            }
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function getFatherBackReferences(firstName) {
    var el = document.getElementById('backreference-response');
    el.innerHTML = "";
    ff.getObjFromUri("/Customers/(firstName eq '" + firstName + "')", function(obj) {
        ff.grabBagGetAll(obj, "BackReferences.Customers.father", function(arr) {
            var str = "";
            var elStr = "";
            var outArray = [];
            if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
            else {
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                var mediaDiv = document.createElement("div");
                mediaDiv.className = "media";
                var mediaBody = document.createElement("div");
                mediaBody.className = "media-body";		 
                var mediaHeading = document.createElement("p");
                mediaHeading.className = "media-heading";		 
                el.appendChild(wellWrap);
                wellWrap.appendChild(mediaDiv);
                for(var i = 0; i < arr.length; i++) {
                    var p = new Customer(arr[i]).printMe();
                    outArray.push(p);
                    var imgA = document.createElement("a");
                    imgA.className = "pull-left";
                    imgA.style.clear = 'both'
                    var img = document.createElement("img");
                    img.className = "media-object";
                    img.src = arrayBufferToDataUri(arr[i].picture);
                    imgA.appendChild(img); 
                    mediaDiv.appendChild(imgA);
                }
                str = js_beautify(JSON.stringify(outArray), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                mediaDiv.appendChild(mediaBody); 
                mediaBody.appendChild(mediaHeading); 
                elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
                mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
            }
        });
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function everyOrderQuery(userName, password) {
    var el = document.getElementById('query-response');
    el.innerHTML = "";
    // ff.logout();
    ff.login("adam@bizgraph.com", "Iwantin123", function() {
        ff.getArrayFromUri("/Orders", function(arr) {
            var str = "";
            var elStr = "";
            var outArray = [];
            if(arr.length <= 0) alert("Create some Order objects in the Orders Collection first!");
            else {
                var wellWrap = document.createElement("div");
                wellWrap.className = "well blue";
                var mediaDiv = document.createElement("div");
                mediaDiv.className = "media";
                var mediaBody = document.createElement("div");
                mediaBody.className = "media-body";		 
                var mediaHeading = document.createElement("p");
                mediaHeading.className = "media-heading";		 
                el.appendChild(wellWrap);
                wellWrap.appendChild(mediaDiv);
                for(var i = 0; i < arr.length; i++) {
                    var p = new Customer(arr[i]).printMe();
                    outArray.push(p);
                    var imgA = document.createElement("a");
                    imgA.className = "pull-left";
                    imgA.style.clear = 'both'
                    var img = document.createElement("img");
                    img.className = "media-object";
                    img.src = arrayBufferToDataUri(arr[i].picture);
                    imgA.appendChild(img); 
                    mediaDiv.appendChild(imgA);
                }
                str = js_beautify(JSON.stringify(outArray), {
                    indent_size: 4,
                    indent_char: '&nbsp;',
                    linefeed_char: '<br>'
                });
                mediaDiv.appendChild(mediaBody); 
                mediaBody.appendChild(mediaHeading); 
                elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
                mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
            }
        }, function(code, msg) {
            el.innerHTML = "<br><div class = 'well red'>Got a retrieve error: " + msg + "</div>";
            console.error("everyOrderQuery() getArrayFromUri Error: " + code + " " + msg);
        });       
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got a login error: " + msg + "</div>";
        console.error("everyOrderQuery() login Error: " + code + " " + msg);
    });
}
function everyMotherQuery() {
    var el = document.getElementById('query-response');
    el.innerHTML = "";
    ff.getArrayFromUri("/Customers/()/mother", function(arr) {
        var str = "";
        var elStr = "";
        var outArray = [];
        if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            for(var i = 0; i < arr.length; i++) {
                var p = new Customer(arr[i]).printMe();
                outArray.push(p);
                var imgA = document.createElement("a");
                imgA.className = "pull-left";
                imgA.style.clear = 'both'
                var img = document.createElement("img");
                img.className = "media-object";
                img.src = arrayBufferToDataUri(arr[i].picture);
                imgA.appendChild(img); 
                mediaDiv.appendChild(imgA);
            }
            str = js_beautify(JSON.stringify(outArray), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
            mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function grandfathersQuery(firstName) {
    var el = document.getElementById('query-response');
    el.innerHTML = "";
    ff.getArrayFromUri("/Customers/(firstName eq '" + firstName + "')/father or mother/()/father", function(arr) {
        var str = "";
        var elStr = "";
        var outArray = [];
        if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            for(var i = 0; i < arr.length; i++) {
                var p = new Customer(arr[i]).printMe();
                outArray.push(p);
                var imgA = document.createElement("a");
                imgA.className = "pull-left";
                imgA.style.clear = 'both'
                var img = document.createElement("img");
                img.className = "media-object";
                img.src = arrayBufferToDataUri(arr[i].picture);
                imgA.appendChild(img); 
                mediaDiv.appendChild(imgA);
            }
            str = js_beautify(JSON.stringify(outArray), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
            mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function grandparentsQuery(firstName) {
    var el = document.getElementById('query-response');
    el.innerHTML = "";
    ff.getArrayFromUri("/Customers/(firstName eq '" + firstName + "')/father or mother/()/mother or father", function(arr) {
        var str = "";
        var elStr = "";
        var outArray = [];
        if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            for(var i = 0; i < arr.length; i++) {
                var p = new Customer(arr[i]).printMe();
                outArray.push(p);
                var imgA = document.createElement("a");
                imgA.className = "pull-left";
                imgA.style.clear = 'both'
                var img = document.createElement("img");
                img.className = "media-object";
                img.src = arrayBufferToDataUri(arr[i].picture);
                imgA.appendChild(img); 
                mediaDiv.appendChild(imgA);
            }
            str = js_beautify(JSON.stringify(outArray), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
            mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function cousinsQuery(firstName) {
    var el = document.getElementById('query-response');
    el.innerHTML = "";
    ff.getArrayFromUri("/Customers/(firstName eq '" + firstName + "')/father or mother/()/siblings/()/BackReferences.Customers.mother or BackReferences.Customers.father", function(arr) {
        var str = "";
        var elStr = "";
        var outArray = [];
        if(arr.length <= 0) alert("Create some Customer objects in the Customers Collection first!");
        else {
            var wellWrap = document.createElement("div");
            wellWrap.className = "well blue";
            var mediaDiv = document.createElement("div");
            mediaDiv.className = "media";
            var mediaBody = document.createElement("div");
            mediaBody.className = "media-body";		 
            var mediaHeading = document.createElement("p");
            mediaHeading.className = "media-heading";		 
            el.appendChild(wellWrap);
            wellWrap.appendChild(mediaDiv);
            for(var i = 0; i < arr.length; i++) {
                var p = new Customer(arr[i]).printMe();
                outArray.push(p);
                var imgA = document.createElement("a");
                imgA.className = "pull-left";
                imgA.style.clear = 'both'
                var img = document.createElement("img");
                img.className = "media-object";
                img.src = arrayBufferToDataUri(arr[i].picture);
                imgA.appendChild(img); 
                mediaDiv.appendChild(imgA);
            }
            str = js_beautify(JSON.stringify(outArray), {
                indent_size: 4,
                indent_char: '&nbsp;',
                linefeed_char: '<br>'
            });
            mediaDiv.appendChild(mediaBody); 
            mediaBody.appendChild(mediaHeading); 
            elStr = arr.length + " Customer objects were retrieved from the Customers Collection with data: " + str;
            mediaHeading.innerHTML = "<br><div class = 'well blue'>" + elStr + "</div>";
        }
    }, function(code, msg) {
        el.innerHTML = "<br><div class = 'well red'>Got an error: " + msg + "</div>";
        console.error("getActorsFromFavs() getArrayFromUri Error: " + code + " " + msg);
    });
}
function arrayBufferToDataUri(arrayBuffer) {
    var base64 = '',
    encodings = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',
    bytes = new Uint8Array(arrayBuffer), byteLength = bytes.byteLength,
    byteRemainder = byteLength % 3, mainLength = byteLength - byteRemainder,
    a, b, c, d, chunk;
    for (var i = 0; i < mainLength; i = i + 3) {
        chunk = (bytes[i] << 16) | (bytes[i + 1] << 8) | bytes[i + 2];
        a = (chunk & 16515072) >> 18; b = (chunk & 258048) >> 12;
        c = (chunk & 4032) >> 6; d = chunk & 63;
        base64 += encodings[a] + encodings[b] + encodings[c] + encodings[d];
    }
    if (byteRemainder == 1) {
        chunk = bytes[mainLength];
        a = (chunk & 252) >> 2;
        b = (chunk & 3) << 4;
        base64 += encodings[a] + encodings[b] + '==';
    } else if (byteRemainder == 2) {
        chunk = (bytes[mainLength] << 8) | bytes[mainLength + 1];
        a = (chunk & 16128) >> 8;
        b = (chunk & 1008) >> 4;
        c = (chunk & 15) << 2;
        base64 += encodings[a] + encodings[b] + encodings[c] + '=';
    }
    return "data:image/png;base64," + base64;
}
// Models
function Customer(obj) {
    this.user = new FFUser();
    this.firstName = null;
    this.lastName = null
    this.email = null;
    this.address = new Address();
    this.phone = null;
    this.metadata = new FFMetaData();
    // this.vendorAccess = null;
    if(obj) {
        this.user = new FFUser();
        this.user.userName = obj.user.userName;
        this.user.firstName = obj.user.firstName;
        this.user.lastName = obj.user.lastName;
        this.user.email = obj.user.email;
        this.user.active = obj.user.active;
        this.firstName = obj.firstName;
        this.lastName = obj.lastName;
        this.email = obj.email;
        this.address = new Address(obj.address);
        this.phone = obj.phone;
        this.metadata = new FFMetaData(obj);
        // this.vendorAccess = obj.vendorAccess;
    }
    return this;
}
function Product(obj) {
    this.description = null;
    this.sku = null;
    this.qrcode = null;
    this.mfg = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.description = obj.description;
        this.sku = obj.sku;
        this.qrcode = obj.qrcode;
        this.mfg = obj.mfg;
        this.metadata = new FFMetaData(obj);
    }
    return this;
}
function OrderLine(obj) {
    this.product = new Product();
    this.quantity = null;
    this.price = null;
    this.total = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.product = new Product(obj.product);
        this.quantity = obj.quantity;
        this.price = obj.price;
        this.total = obj.total;
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Order(obj) {    
    this.customer = new Customer();
    this.vendor = new Vendor();
    this.total = null;
    this.placedAt = new Address();
    this.metadata = new FFMetaData();
    if(obj) {
        this.customer = new Customer(obj.customer);
        this.vendor = new Vendor(obj.vendor);
        this.total = obj.total;
        this.placedAt = new Address(obj.placedAt);
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Vendor (obj) {
    this.name = null;
    this.logo = null;
    this.address = new Address();
    this.metadata = new FFMetaData();
    if(obj) {
        this.name = obj.name;
        this.logo = obj.ffUrl + "/logo";
        this.address = new Address(obj.address);
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Manufacturer (obj) {
    this.name = null;
    this.address = new Address();
    this.logo = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.name = obj.name;
        this.address = new Address(obj.address);
        this.logo = obj.ffUrl + "/logo";
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Price(obj) {
    this.price = null;
    this.product = new Product();
    this.vendor = new Vendor();
    this.metadata = new FFMetaData();
    if(obj) {
        this.name = obj.name;
        this.address = new Address(obj.address);
        this.logo = obj.ffUrl + "/logo";
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Address(obj) {
    this.street = null;
    this.city = null;
    this.state = null;
    this.country = null;
    this.postCode = null;
    this.location = new Location();
    this.metadata = new FFMetaData();
    if(obj) {
        this.street = obj.street;
        this.city = obj.city;
        this.state = obj.state;
        this.country = obj.country;
        this.postCode = obj.postCode;
        this.location = new Location(obj.location);
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Location(obj) {
    this.geo = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.geo = obj.geo;
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Account(obj) {
    this.customer = new Customer();
    this.paymentMethods = [];
    this.metadata = new FFMetaData();
    if(obj) {
        this.customer = new Customer(obj.customer);
        this.paymentMethods = obj.paymentMethods;
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function ProductImage(obj) {
    this.image = null;
    this.product = new Product();
    this.metadata = new FFMetaData();
    if(obj) {
        this.image = obj.ffUrl + "/image";
        this.product = new Product(obj.product);
        this.metadata = new FFMetaData(obj);
    }
    return this;    
}
function Avatar(obj) {
    this.image = null;
    this.nickname = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.image = obj.ffUrl + "/image";
        this.nickname = obj.nickname;
        this.metadata = new FFMetaData(obj);
    }
    return this;        
}
function Rating(obj) {
    this.relatesTo = null;
    this.geo = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.relatesTo = obj.relatesTo;
        this.geo = obj.geo;
        this.metadata = new FFMetaData(obj);
    }
    return this;        
}
function Comment (obj) {
    this.relatesTo = null;
    this.comment = null;
    this.geo = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.relatesTo = obj.relatesTo;
        this.comment = obj.comment;
        this.geo = obj.geo;
        this.metadata = new FFMetaData(obj);
    }
    return this;        
}
function Like (obj) {
    this.relatesTo = null;
    this.geo = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.relatesTo = obj.relatesTo;
        this.geo = obj.geo;
        this.metadata = new FFMetaData(obj);
    }
    return this;        
}
function QRCode (obj) {
    this.image = null;
    this.metadata = new FFMetaData();
    if(obj) {
        this.image = obj.ffUrl + "/image";
        this.metadata = new FFMetaData(obj);
    }
    return this;        
}
// Instantiating the FatFractal instance
var ff = new FatFractal();
</script>
</html>
